# SNIK-Toolset, Maintainer: Konrad Höffner <konrad.hoeffner@imise.uni-leipzig.de>, originally Sebastian Stäubert  <sebastian.staeubert@imise.uni-leipzig.de>

services:

#  rdf:
#    build: ../ontology
#    volumes:
#      - rdf:/ontology

  virtuoso:
    build: ./virtuoso
    environment:
      - DBA_PASSWORD=${DBA_PASSWORD}
      - SPARQL_UPDATE='false'
    volumes:
      - virtuoso-data:/data
      - ../ontology:/data/toLoad:ro
    ports:
      - "127.0.0.1:8081:8890"
      - "127.0.0.1:1111:1111"
    restart: unless-stopped

  graph:
    build:
      context: ../graph
      args:
      # client side, so we use the port on the local machine
        - SPARQL_ENDPOINT=http://127.0.0.1:8081/sparql
    ports:
      - "127.0.0.1:8043:8043"
    depends_on: 
      - virtuoso

# Access at http://localhost:8889/ontology
  lodview:
    # subfolder, uses the master branch of https://github.com/snikproject/lodview
    # ignore the Dockerfile in the lodview Git repository, it is not used here and may have different settings
    build:
      context: ../lodview
      args:
      # server side, so we use the port on the internal port
        - SPARQL_ENDPOINT=http://virtuoso:8890/sparql
    ports:
      - "127.0.0.1:8889:8080"
    depends_on: 
      - virtuoso
    restart: unless-stopped

volumes:
  rdf:
  virtuoso-data:

